---
enable html: true
---
# 主机部署

除了可以将软件部署到K8s外，您还可以将软件直接部署到Linux、Windows主机。

### 前提条件
* 如果部署文件来源为制品库，则在添加主机部署步骤前，需要先将文件仓库的文件版本设置为[制品库文件仓库类参数](12.6.1-set-parms.md#添加制品库文件仓库类参数)中的“版本号”参数。

### 背景信息       
主机部署的部署文件来源包括：
* **代码库**           
  表示部署文件可以是代码库的原始文件，也可以是编译构建后的文件，具体文件通过“部署文件相对路径”指定。    
  流水线执行时，会将代码源中的代码缓存在执行机的某个路径（假设为A目录）下，并且编译构建后的文档及其相对路径也会存放在执行的A目录下。当“部署文件来源”选择为“代码库”时，A目录即为文件根目录。      
* **制品库**         
  表示部署文件从“制品库 > 文件仓库”中获取。
* **其他地址**      
  当前版本暂不支持，后续版本支持。     

### 操作步骤
1. 在流水线的任务编辑页面中，添加“部署 > 主机部署”步骤。
2. 根据下表的描述，配置“主机部署”步骤，单击“保存”。        
  <img src="fig/流水线-主机部署.png" style="zoom:50%">     
    <table>
<tr>
    <th>参数</th>
    <th>说明</th>
</tr>
<tr>
    <td>步骤名称 </td>
    <td>自定义步骤的名称。支持最多32个字符。</td>
</tr>
<tr>
    <td>部署文件来源 </td>
    <td><ul><li>代码库：从执行机的“部署文件相对路径”中获取代码部署文件。</li><li>制品库：从制品库的文件仓库中拉取软件包作为部署文件。</li><li>其他路径：暂不支持，后续版本支持。</li></ul></td>
</tr>
<tr>
    <td>部署文件相对路径</td>
    <td>“部署文件来源”选择“代码库”时，本参数有效。<p>表示部署文件相对于文件根目录的相对路径。最多支持128个字符。</p></td>
</tr>
<tr>
    <td>过滤规则表达式</td>
    <td>选择部署文件时，将排除满足表达式条件的文件和文件夹。可通过参数右侧的“添加”按钮，添加多条规则。有多条规则时，取所有规则的并集。<p>表达式从项目根目录开始匹配：“?”匹配单个字符；“** ”匹配多个文件夹；“* ”匹配多个字符。例如，匹配src目录下的Java文件，则表达式设置为：src/** /*.java。</p></td>
</tr>
<tr>
    <td>制品库文件仓库文件版本</td>
    <td>“部署文件来源”选择“制品库”时，本参数有效。<p>您需要先将文件仓库的文件版本设置为<a href="12.6.1-set-parms.md#添加制品库文件仓库类参数">制品库文件仓库类参数</a>中的“版本号”参数，然后从下拉菜单中选择。</td>
    </tr>
  <tr>
    <td>主机信息</td>
    <td>表示部署到哪个主机。主机信息来源于“项目设置 > 接入点设置 > <a href="6.7.2-manage-hosts.md">主机管理</a>”中的添加的主机。</td>
  </tr>
<tr>
    <td>主机文件部署目录</td>
    <td>表示将部署文件上传到主机的哪个目录。该目录为绝对路径，且主机信息中的用户对该目录必须具有可写权限。<p>勾选“清空文件”后，系统会自动将主机对应目录下的文件都删除。</p></td>
</tr>
<tr>
    <td>失败后继续运行</td>
    <td>表示当前步骤执行失败后，继续执行后续的步骤。</td>
</tr>
<tr>
    <td>命令</td>
    <td>输入在主机上执行的软件部署命令，执行部署。</td>
</tr>
</table>

